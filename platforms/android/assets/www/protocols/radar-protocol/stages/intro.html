<div class="container">
	<div class="row">
		<div class="col-md-12">
			<div class="row study-welcome">
				<div class="col-md-12">
					<h1 class='text-center'>Welcome to the CTAAP Study.</h1>
				</div>
			</div>
		  	<form role="form" id="step1">
				<div class="row welcome-row">
			  		<div class="col-md-6 form-group">
			  			<label for="radarID">CTAAP ID:</label>
					  	<input type="number" class="form-control radarID" id="radarID" required>
					</div>
			  		<div class="col-md-6 form-group">
			  			<label for="interviewerID">Staff ID:</label>
					  	<input type="number" class="form-control interviewerID" id="interviewerID" required>
					</div>
				</div>
				<div class="row welcome-row">
					<div class="col-md-12 form-group">
						<label for="sessionID">Session ID:</label>
					  	<input type="text" class="form-control sessionID" id="sessionID" disabled>
					</div>
				</div>
				<div class="row welcome-row">
					<div class="col-md-12">
						<label>Participant's Gender:</label>
						<br>
						<div class="btn-group big-check" data-toggle="buttons">
							<label class="btn">
								<input type="radio" name='gender_k' data-value="Male" checked><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">Male</span>
							</label>
							<label class="btn">
								<input type="radio" name='gender_k' data-value="Female"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">Female</span>
							</label>
							<label class="btn">
								<input type="radio" name='gender_k' data-value="Transgender: Female to Male"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">Transgender: Female to Male</span>
							</label>
							<label class="btn">
								<input type="radio" name='gender_k' data-value="Transgender: Male to Female"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">Transgender: Male to Female</span>
							</label>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12 welcome-row">
						<label>Participant's Seed Status:</label>
						<br>
		                <div class="btn-group big-check" data-toggle="buttons">
		                    <label class="btn">
		                      <input type="radio" name='seed_status_t0' data-value="Seed" checked><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">Seed</span>
		                    </label>
		                    <label class="btn">
		                      <input type="radio" name='seed_status_t0' data-value="Non-Seed"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">Non-Seed</span>
		                    </label>
		                </div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12 welcome-row">
						<label>Visit Number:</label>
						<br>
		                <div class="btn-group big-check" data-toggle="buttons">
		                    <label class="btn">
		                    	<input type="radio" name='visit_number' data-value="1" checked><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">1</span>
		                    </label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="2"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">2</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="3"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">3</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="4"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">4</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="5"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">5</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="6"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">6</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="7"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">7</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="8"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">8</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="9"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">9</span>
							</label>
							<label class="btn">
								<input type="radio" name='visit_number' data-value="10"><i class="fa fa-circle-o fa-3x"></i><i class="fa fa-check-circle-o fa-3x"></i> <span class="check-number">10</span>
							</label>
						</div>
					</div>
				</div>
				<div class="row welcome-row-submit">
	                <div class="col-md-12 form-group">
					  	<button type="submit" class="btn btn-primary submit-1">Continue</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>
<script>
	// Make right arrow submit form instead of advancing stage.
	// This caused the most hideous bug imaginable. For some reason hiding the arrow causes the menu not to scroll.

	// $('.arrow-next').fadeOut();

	// Focus on the first field.
	$('.radarID').focus();

	// Populate existing data if it exists
	var readable = new Date(window.netCanvas.Modules.session.returnData('session').int_stime);
	$('.sessionID').val(window.netCanvas.Modules.session.returnSessionID);
	$('.radarID').val(window.network.getNode(0).radar_id);

	// Populate gender
	$("input:radio[name=gender_k][data-value='"+window.network.getNode(0).gender_k+"']").prop('checked', true);
	$("input:radio[name=gender_k][data-value='"+window.network.getNode(0).gender_k+"']").parent().addClass('active');

	// Populate Seed Status
	$("input:radio[name=seed_status_t0][data-value='"+window.network.getNode(0).seed_status_t0+"']").prop('checked', true);
	$("input:radio[name=seed_status_t0][data-value='"+window.network.getNode(0).seed_status_t0+"']").parent().addClass('active');

	// Populate Visit Number
	$("input:radio[name=visit_number][data-value='"+window.network.getNode(0).visit_number+"']").prop('checked', true);
	$("input:radio[name=visit_number][data-value='"+window.network.getNode(0).visit_number+"']").parent().addClass('active');

	// Populate interviewer ID
	var sessionParameters = window.netCanvas.Modules.session.returnData('sessionParameters');
	$('.interviewerID').val(sessionParameters.interviewerID);


	$("#step1").submit(function( event ) {

		// Prevent the form actually submitting. We're going to process the data manually.
		event.preventDefault();

	  // check if ego node already exists
	  if (window.network.getEgo() === false) {
		// if not, create a new root node
		  window.network.createEgo({
		  	label:'Root',
			visit_number: $("input:radio[name=visit_number]:checked").data('value'),
		  	radar_id: $('.radarID').val(),
			gender_k: $("input:radio[name=gender_k]:checked").data('value'),
		  	seed_status_t0: $("input:radio[name=seed_status_t0]:checked").data('value')
		  });

	  } else {

		// update an existing node
		var ego = window.network.getEgo();
		window.network.updateNode(ego.id,{
			label:'Root',
			visit_number: $("input:radio[name=visit_number]:checked").data('value'),
			radar_id: $('.radarID').val(),
			gender_k: $("input:radio[name=gender_k]:checked").data('value'),
			seed_status_t0: $("input:radio[name=seed_status_t0]:checked").data('value')
		});


	  }
		// Store interviewer id
		sessionParameters.interviewerID = $('.interviewerID').val();

		// Continue to next stage
		// TODO: check that everything worked first and fire a validation callback.
		window.netCanvas.Modules.session.nextStage();
	});

</script>
